"use strict";
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
Object.defineProperty(exports, "__esModule", { value: true });
exports.toMenuItems = toMenuItems;
require("../../../../base/browser/ui/codicons/codiconStyles.js"); // The codicon symbol styles are defined here and must be loaded
const codicons_js_1 = require("../../../../base/common/codicons.js");
const types_js_1 = require("../common/types.js");
require("../../symbolIcons/browser/symbolIcons.js"); // The codicon symbol colors are defined here and must be loaded to get colors
const nls_js_1 = require("../../../../nls.js");
const hierarchicalKind_js_1 = require("../../../../base/common/hierarchicalKind.js");
const uncategorizedCodeActionGroup = Object.freeze({ kind: hierarchicalKind_js_1.HierarchicalKind.Empty, title: (0, nls_js_1.localize)('codeAction.widget.id.more', 'More Actions...') });
const codeActionGroups = Object.freeze([
    { kind: types_js_1.CodeActionKind.QuickFix, title: (0, nls_js_1.localize)('codeAction.widget.id.quickfix', 'Quick Fix') },
    { kind: types_js_1.CodeActionKind.RefactorExtract, title: (0, nls_js_1.localize)('codeAction.widget.id.extract', 'Extract'), icon: codicons_js_1.Codicon.wrench },
    { kind: types_js_1.CodeActionKind.RefactorInline, title: (0, nls_js_1.localize)('codeAction.widget.id.inline', 'Inline'), icon: codicons_js_1.Codicon.wrench },
    { kind: types_js_1.CodeActionKind.RefactorRewrite, title: (0, nls_js_1.localize)('codeAction.widget.id.convert', 'Rewrite'), icon: codicons_js_1.Codicon.wrench },
    { kind: types_js_1.CodeActionKind.RefactorMove, title: (0, nls_js_1.localize)('codeAction.widget.id.move', 'Move'), icon: codicons_js_1.Codicon.wrench },
    { kind: types_js_1.CodeActionKind.SurroundWith, title: (0, nls_js_1.localize)('codeAction.widget.id.surround', 'Surround With'), icon: codicons_js_1.Codicon.surroundWith },
    { kind: types_js_1.CodeActionKind.Source, title: (0, nls_js_1.localize)('codeAction.widget.id.source', 'Source Action'), icon: codicons_js_1.Codicon.symbolFile },
    uncategorizedCodeActionGroup,
]);
function toMenuItems(inputCodeActions, showHeaders, keybindingResolver) {
    if (!showHeaders) {
        return inputCodeActions.map((action) => {
            return {
                kind: "action" /* ActionListItemKind.Action */,
                item: action,
                group: uncategorizedCodeActionGroup,
                disabled: !!action.action.disabled,
                label: action.action.disabled || action.action.title,
                canPreview: !!action.action.edit?.edits.length,
            };
        });
    }
    // Group code actions
    const menuEntries = codeActionGroups.map(group => ({ group, actions: [] }));
    for (const action of inputCodeActions) {
        const kind = action.action.kind ? new hierarchicalKind_js_1.HierarchicalKind(action.action.kind) : hierarchicalKind_js_1.HierarchicalKind.None;
        for (const menuEntry of menuEntries) {
            if (menuEntry.group.kind.contains(kind)) {
                menuEntry.actions.push(action);
                break;
            }
        }
    }
    const allMenuItems = [];
    for (const menuEntry of menuEntries) {
        if (menuEntry.actions.length) {
            allMenuItems.push({ kind: "header" /* ActionListItemKind.Header */, group: menuEntry.group });
            for (const action of menuEntry.actions) {
                const group = menuEntry.group;
                allMenuItems.push({
                    kind: "action" /* ActionListItemKind.Action */,
                    item: action,
                    group: action.action.isAI ? { title: group.title, kind: group.kind, icon: codicons_js_1.Codicon.sparkle } : group,
                    label: action.action.title,
                    disabled: !!action.action.disabled,
                    keybinding: keybindingResolver(action.action),
                });
            }
        }
    }
    return allMenuItems;
}
//# sourceMappingURL=codeActionMenu.js.map